{"version":3,"sources":["../../src/pages/profile/profile-settings.module.ts","../../src/pages/profile/profile-settings.ts"],"names":[],"mappings":"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","file":"22.js","sourcesContent":["import { ProfileSettingsPage } from './profile-settings';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ProfileSettingsPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ProfileSettingsPage),\r\n  ],\r\n  exports: [\r\n    ProfileSettingsPage\r\n  ]\r\n})\r\n\r\nexport class ProfileSettingsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile-settings.module.ts","import {UserService} from \"../../providers/user.service\";\nimport {Component} from '@angular/core';\nimport {Camera} from '@ionic-native/camera';\nimport {AlertController, IonicPage, MenuController, NavController, NavParams, ToastController} from 'ionic-angular';\nimport {AppState} from \"../../app/global.setting\";\nimport {Geolocation} from '@ionic-native/geolocation';\n\n@IonicPage()\n@Component({\n  selector: 'page-profile-settings',\n  templateUrl: 'profile-settings.html',\n})\n\nexport class ProfileSettingsPage {\n  errorMessage: any;\n  placeholderPicture = 'assets/img/avatar/user-avatar.png';\n\n  profil: any = {};\n\n  languages = ['English'];\n  paymentMethods = ['ETH', 'BTC', 'GAS'];\n  currencies = ['USD', 'EUR'];\n\n  displayUpdate = false;\n\n  isNew = false;\n\n  isPass = false;\n  alive: boolean = true;\n\n  constructor(\n    public userService: UserService,\n    public toastCtrl: ToastController,\n    public camera: Camera,\n    public navCtrl: NavController,\n    public params: NavParams,\n    public global: AppState,\n    public menuCtrl: MenuController,\n    public geolocation: Geolocation,\n    public alertCtrl: AlertController\n  ) { }\n\n  ionViewWillEnter() {\n    if(this.params.get(\"isNew\")) {\n      this.isNew = true;\n      this.profil.language = this.languages[0];\n    }\n\n    if(this.userService._profil && !this.isNew) {\n      this.profil = this.userService._profil;\n    }\n  }\n\n  ionViewWillLeave() {\n    this.alive = false;\n  }\n\n  updateProfileImage() {\n    this.camera.getPicture({\n      quality: 50,\n      allowEdit: true,\n      cameraDirection: this.camera.Direction.FRONT,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE\n    }).then((imageData) => {\n      this.profil.imageUrl = \"data:image/jpeg;base64,\" + imageData;\n      this.update();\n    }, (err) => {\n      this.toastCtrl.create('Error: ' + err);\n    });\n  }\n\n  updateData() {\n    if(!this.checkForm()) {\n      return false;\n    }\n\n    if(!this.isNew) {\n      this.profil.uid = this.userService._userFirebase.uid;\n      this.profil.username = this.userService._user.username;\n      this.isPass = true;\n      this.userService.saveProfil(this.profil);\n      this.userService._profil = this.profil;\n\n      this.toastCtrl.create({\n        message: 'Profil updated',\n        duration: 2000,\n        position: 'bottom'\n      }).present();\n\n      if(!this.isNew) {\n        this.navCtrl.pop();\n      }\n      return true;\n    } else {\n      this.userService.getUidFromPseudo(this.profil.pseudo)\n        .takeWhile(() => this.alive)\n        .subscribe(uid => {\n        if(!uid.$value || !this.isNew) {\n          this.profil.uid = this.userService._userFirebase.uid;\n          this.profil.username = this.userService._user.username;\n          this.isPass = true;\n          this.userService.saveProfil(this.profil);\n          this.userService._profil = this.profil;\n          this.global.set('profil', this.profil);\n\n          this.toastCtrl.create({\n            message: 'Profil updated',\n            duration: 2000,\n            position: 'bottom'\n          }).present();\n\n          if(!this.isNew) {\n            this.navCtrl.pop();\n          }\n\n          this.menuCtrl.enable(true, 'menu-material');\n          this.navCtrl.setRoot('TabsPage');\n          return true;\n        } else {\n          if(!this.isPass) {\n            let toast = this.toastCtrl.create({\n              message: 'Pseudo already used, choose a new one',\n              duration: 2000,\n              position: 'bottom'\n            });\n            toast.present(toast);\n            return false;\n          }\n        }\n      });\n    }\n  }\n\n  checkForm() {\n    if(!this.profil.pseudo || !this.profil.lastName || !this.profil.firstName || !this.profil.language || !this.profil.paymentMethod || !this.profil.currency) {\n      this.toastCtrl.create({\n        message: 'Please fill all fields',\n        duration: 2000,\n        position: 'bottom'\n      }).present();\n      return false;\n    }\n    return true;\n  }\n\n  update() {\n    if(!this.isNew) {\n      this.displayUpdate = true;\n    }\n  }\n\n  next() {\n    this.updateData();\n  }\n\n  checkPseudo() {\n    return this.userService.getUidFromPseudo(this.profil.pseudo)\n      .takeWhile(() => this.alive)\n      .subscribe(uid => {\n      if(uid.$value) {\n        if(!this.isPass) {\n          this.toastCtrl.create({\n            message: 'Pseudo already used, choose a new one',\n            duration: 2000,\n            position: 'bottom'\n          }).present();\n        }\n      }\n    });\n  }\n\n  showFiatEchange() {\n    if (this.profil.position) {\n      let confirm = this.alertCtrl.create({\n        title: 'Fiat exchange',\n        message: 'Your position will be displayed on the map.',\n        cssClass: 'confirm-alert',\n        buttons: [\n          {\n            text: 'Cancel',\n            handler: () => {\n              //console.log('Disagree clicked');\n            }\n          },\n          {\n            text: 'Confirm',\n            handler: () => {\n              this.geolocation.getCurrentPosition({ maximumAge: 30000, timeout: 3000, enableHighAccuracy: true })\n                .then((position) => {\n                  this.profil.position = true;\n                  this.userService.saveProfilPosition(\n                    position.coords.latitude + Math.random() * (0.0019 + 0.0019) - 0.0019,\n                    position.coords.longitude + Math.random() * (0.0019 + 0.0019) - 0.0019);\n                  if(!this.isNew) {\n                    this.userService.saveProfil(this.profil);\n                  }\n                }).catch((error) => {\n                //console.log('Error : ', error);\n                const alert = this.alertCtrl.create({\n                  title: 'Error',\n                  subTitle: 'Error while getting your position, try again',\n                  buttons: ['Close']\n                });\n                alert.present();\n              });\n            }\n          }\n        ]\n      });\n      confirm.present();\n    } else {\n      this.profil.position = false;\n      this.userService.deleteProfilPosition();\n      if(!this.isNew) {\n        this.userService.saveProfil(this.profil);\n      }\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/profile-settings.ts"],"sourceRoot":""}