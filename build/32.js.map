{"version":3,"sources":["../../src/pages/auth/login.module.ts","../../src/pages/auth/login.ts"],"names":[],"mappings":"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","file":"32.js","sourcesContent":["import { LoginPage } from './login';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    LoginPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(LoginPage),\r\n  ],\r\n  exports: [\r\n    LoginPage\r\n  ]\r\n})\r\n\r\nexport class LoginSliderPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/login.module.ts","// import { FormBuilder, FormControl, Validator } from '@angular/forms';\nimport {Component, ViewChild} from '@angular/core';\nimport {AlertController, IonicPage, LoadingController, MenuController, NavController, Slides} from 'ionic-angular';\nimport {AngularFireAuth} from \"angularfire2/auth\";\nimport * as firebase from 'firebase/app';\nimport {UserService} from \"../../providers/user.service\";\nimport {AppState} from \"../../app/global.setting\";\nimport * as CryptoJS from 'crypto-js';\nimport {WalletService} from \"../../providers/wallet.service\";\nimport {Web3Service} from \"../../providers/web3.service\";\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class LoginPage {\n  public loginForm: any;\n  confirmPassword: string;\n\n  alive: boolean = true;\n\n  account: { username: string, password: string } = {\n    username: '',\n    password: ''\n  };\n\n  constructor(\n    private userService: UserService,\n    public navCtrl: NavController,\n    public loadingCtrl: LoadingController,\n    public alertCtrl: AlertController,\n    public afAuth: AngularFireAuth,\n    public global: AppState,\n    public menuCtrl: MenuController,\n    private walletService: WalletService,\n    private web3Service: Web3Service,\n  ) { }\n\n  // Slider methods\n  @ViewChild('slider') slider: Slides;\n  @ViewChild('innerSlider') innerSlider: Slides;\n\n  goToLogin() {\n    this.navCtrl.push('FirebaseLoginPage');\n  }\n\n  goToSignup() {\n    this.navCtrl.push('RegisterPage');\n  }\n\n  slideNext() {\n    this.innerSlider.slideNext();\n  }\n\n  slidePrevious() {\n    this.innerSlider.slidePrev();\n  }\n\n  presentLoading(message) {\n    const loading = this.loadingCtrl.create({\n      duration: 500\n    });\n\n    loading.onDidDismiss(() => {\n      const alert = this.alertCtrl.create({\n        title: 'Success',\n        subTitle: message,\n        buttons: ['Dismiss']\n      });\n      alert.present();\n    });\n\n    loading.present();\n  }\n\n  ionViewDidLoad() {\n    //Check if already authenticated\n\n    this.userService.checkAuthentication().takeWhile(() => this.alive).subscribe(auth => {\n      if(auth) {\n        this.userService.getProfil(auth.uid).takeWhile(() => this.alive).subscribe(p =>{\n          this.userService._profil = p;\n          this.global.set('profil', p);\n\n          var password = null;\n          var decrypted = null;\n\n          let prompt = this.alertCtrl.create({\n            title: 'Unlock your wallet',\n            subTitle: 'Enter your password',\n            cssClass: 'promt-alert',\n            inputs: [\n              {\n                name: 'password',\n                placeholder: 'Password',\n                type: 'password'\n              },\n            ],\n            buttons: [\n              {\n                text: 'Cancel',\n                handler: data => {\n                  //console.log('Cancel clicked');\n                }\n              },\n              {\n                text: 'Validate',\n                handler: data => {\n                  password = data.password.trim();\n\n                  var decrypted = null;\n                  try {\n                    decrypted = CryptoJS.AES.decrypt(this.walletService.wallets.eth.private, password);\n                  } catch (e){\n                    decrypted = null;\n                  }\n\n                  if(decrypted) {\n                    this.web3Service.initWeb3(password, this.walletService.wallets.eth.private, this.walletService.wallets.eth.address);\n\n                    this.menuCtrl.enable(true, 'menu-material');\n                    if(!this.userService._profil.uid) {\n                      this.navCtrl.setRoot('ProfileSettingsPage', {isNew: true});\n                    } else {\n                      this.navCtrl.setRoot('TabsPage');\n                    }\n                  }\n                }\n              }\n            ]\n          });\n          prompt.present();\n\n        });\n      }\n    });\n  }\n\n  ionViewWillLeave() {\n    this.alive = false;\n  }\n\n  // Attempt to login in through our User service\n  login() {\n    const loading = this.loadingCtrl.create({\n      content: 'Please wait while login'\n    });\n\n    loading.present();\n\n    if(!this.account.username || !this.account.password) {\n      const alert = this.alertCtrl.create({\n        title: 'Error',\n        subTitle: 'Please fill fields',\n        buttons: ['Dismiss']\n      });\n      loading.dismissAll();\n      alert.present();\n      return;\n    }\n\n    this.userService.login(this.account).then(resp => {\n      loading.dismissAll();\n      this.userService.getProfil(resp.uid).takeWhile(() => this.alive).subscribe(p =>{\n        this.userService._profil = p;\n        this.global.set('profil', p);\n\n        this.menuCtrl.enable(true, 'menu-material');\n        if(!this.userService._profil.uid) {\n          this.navCtrl.setRoot('ProfileSettingsPage', {isNew: true});\n        } else {\n          this.navCtrl.setRoot('TabsPage');\n        }\n      });\n    }, err => {\n      const alert1 = this.alertCtrl.create({\n        title: 'Error',\n        subTitle: 'No valid email/password',\n        buttons: ['Dismiss']\n      });\n      loading.dismissAll();\n      alert1.present();\n    });\n\n\n  }\n\n  signup() {\n    if(!this.account.username || !this.account.password || this.account.password != this.confirmPassword) {\n      const alert = this.alertCtrl.create({\n        title: 'Error',\n        subTitle: 'No valid email/password',\n        buttons: ['Dismiss']\n      });\n      alert.present();\n      return;\n    }\n\n    const loading = this.loadingCtrl.create({\n      content: 'Please wait while creating your account'\n    });\n\n    loading.present();\n\n    this.userService.signup(this.account).then(resp => {\n      this.userService.login(this.account).then(resp1 => {\n        loading.dismissAll();\n        this.navCtrl.setRoot('ProfileSettingsPage', {isNew: true});\n      }, err => {\n        const alert1 = this.alertCtrl.create({\n          title: 'Error',\n          subTitle: 'No valid email/password',\n          buttons: ['Dismiss']\n        });\n        loading.dismissAll();\n        alert1.present();\n      });\n    }).catch(\n      (err) => {\n        //console.log(\"Unable to sign up\", err);\n        loading.dismissAll();\n        this.alertCtrl.create({\n          title: 'Error',\n          subTitle: err.message,\n          buttons: ['Close']\n        }).present();\n      });\n  }\n\n  resetPassword() {\n    this.presentLoading('An e-mail was sent with your new password.');\n  }\n\n\n  loginGoogle() {\n    this.afAuth.auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(\n      (success) => {\n        this.navCtrl.setRoot('TabsPage');\n      }).catch(\n      (err) => {\n        //console.log(\"Unable to log in\", err);\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/login.ts"],"sourceRoot":""}