{"version":3,"sources":["../../src/pages/store/store.module.ts","../../src/pages/store/store.ts"],"names":[],"mappings":"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","file":"15.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {StorePage} from './store';\nimport {SharedModule} from \"../../app/shared.module\";\nimport {Ionic2RatingModule} from \"ionic2-rating\";\n\n@NgModule({\n  declarations: [\n    StorePage\n  ],\n  imports: [\n    IonicPageModule.forChild(StorePage),\n    SharedModule,\n    Ionic2RatingModule\n  ],\n  exports: [\n    StorePage\n  ]\n})\nexport class MasonryCardsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/store/store.module.ts","import {Component, ViewChild} from '@angular/core';\nimport {IonicPage, NavController, NavParams, Searchbar, ViewController} from 'ionic-angular';\nimport {ArticleService} from \"../../providers/article.service\";\nimport {Geolocation} from '@ionic-native/geolocation';\nimport {UserService} from \"../../providers/user.service\";\n\n@IonicPage()\n@Component({\n  selector: 'page-store',\n  templateUrl: 'store.html',\n})\nexport class StorePage {\n  @ViewChild('searchbar') searchbar:Searchbar;\n\n  type: string = \"products\";\n  articles = [];\n  articles_backup = [];\n  position: any = {latitude : 0, longitude: 0};\n\n  subscribeArticle;\n\n  valueSearch: string;\n  isDisplaySearch: boolean;\n  onFocusSearch: boolean;\n  alive: boolean = true;\n\n  profil: any = {};\n\n  constructor(public navCtrl: NavController,\n              public viewCtrl: ViewController,\n              public navParams: NavParams,\n              private articleService: ArticleService,\n              private userService: UserService,\n              public geolocation: Geolocation) {\n\n    this.profil['rate'] = 0;\n\n  }\n\n  showPage(page) {\n    this.navCtrl\n      .push(page)\n      .then(() => {\n        const index = this.viewCtrl.index;\n        this.navCtrl.remove(index);\n      });\n  }\n\n  ionViewWillLeave() {\n    this.alive = false;\n  }\n\n  ionViewDidLoad() {\n    //this.articles = this.articleService.getArticles();\n    this.subscribeArticle = this.articleService.getArticles().takeWhile(() => this.alive).subscribe(articles => {\n        articles.forEach(article => {{\n            this.articles.push(article);\n            this.articles_backup.push(article);\n        }\n      })\n    });\n    this.geolocation.getCurrentPosition({ maximumAge: 3000, timeout: 5000, enableHighAccuracy: true })\n      .then((position) => {\n        this.position.latitude = position.coords.latitude;\n        this.position.longitude = position.coords.longitude;\n      }).catch(err => {\n      this.position.latitude = \"n/a\";\n      this.position.longitude = \"n/a\";\n    });\n  }\n\n  getProfil(uid) {\n    return this.userService.getProfil(uid);\n  }\n\n  displaySearchBar() {\n    this.isDisplaySearch = !this.isDisplaySearch\n    if(this.isDisplaySearch) {\n      setTimeout(() => {\n        this.searchbar.setFocus();\n      });\n    };\n  }\n\n  seeDetails(item) {\n    //console.log(item);\n    this.navCtrl.push('ArticlePage',\n      {article: item, key: item.$key});\n  }\n\n  seeDetailsService(item) {\n    //console.log(item);\n    this.navCtrl.push('ServicePage',\n      {service: item, key: item.$key});\n  }\n\n  calculateDistance(value) {\n    if (value) {\n      const positions = value.split(':');\n      const me = positions[0].split(',');\n      const other = positions[1].split(',');\n\n      return getDistanceFromLatLonInKm(me[0], me[1], other[0], other[1]).toFixed(1);\n    }\n  }\n\n  getItems(ev) {\n    this.articles = this.articles_backup;\n    // set val to the value of the ev target\n    var val = ev.target.value;\n    this.valueSearch = val;\n\n    // if the value is an empty string don't filter the items\n    if (val) {\n      let text = val.toLowerCase();\n      this.articles = this.articles\n        .filter((article) => {\n          return article.title.toLowerCase().indexOf(text) >= 0\n            || article.type.toLowerCase().indexOf(text) >= 0\n            || article.description.toLowerCase().indexOf(text) >= 0\n            || article.brand.toLowerCase().indexOf(text) >= 0;\n      });\n    }\n  }\n}\n\nfunction getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\n  var R = 6371; // Radius of the earth in km\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\n  var dLon = deg2rad(lon2-lon1);\n  var a =\n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n    Math.sin(dLon/2) * Math.sin(dLon/2)\n  ;\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  var d = R * c; // Distance in km\n  return d;\n}\n\nfunction deg2rad(deg) {\n  return deg * (Math.PI/180)\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/store/store.ts"],"sourceRoot":""}