{"version":3,"sources":["../../src/pages/store/store.module.ts","../../src/pages/store/store.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAuC;AACO;AACZ;AAalC,IAAa,sBAAsB;IAAnC;IAAqC,CAAC;IAAD,6BAAC;AAAD,CAAC;AAAzB,sBAAsB;IAXlC,uEAAQ,CAAC;QACR,YAAY,EAAE;YACZ,yDAAS;SACV;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,yDAAS,CAAC;SACpC;QACD,OAAO,EAAE;YACP,yDAAS;SACV;KACF,CAAC;GACW,sBAAsB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;ACfgB;AAC0B;AACd;AACT;AAOtD,IAAa,SAAS;IAepB,mBAAmB,OAAsB,EACtB,SAAoB,EACnB,cAA8B,EAC/B,WAAwB;QAHxB,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACnB,mBAAc,GAAd,cAAc,CAAgB;QAC/B,gBAAW,GAAX,WAAW,CAAa;QAf3C,SAAI,GAAW,UAAU,CAAC;QAC1B,aAAQ,GAAG,EAAE,CAAC;QACd,oBAAe,GAAG,EAAE,CAAC;QACrB,aAAQ,GAAQ,EAAC,QAAQ,EAAG,CAAC,EAAE,SAAS,EAAE,CAAC,EAAC,CAAC;QAO7C,UAAK,GAAY,IAAI,CAAC;IAOtB,CAAC;IAED,oCAAgB,GAAhB;QACE,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAED,kCAAc,GAAd;QAAA,iBAiBC;QAhBC,oDAAoD;QACpD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC,cAAM,YAAI,CAAC,KAAK,EAAV,CAAU,CAAC,CAAC,SAAS,CAAC,kBAAQ;YACpG,QAAQ,CAAC,OAAO,CAAC,iBAAO;gBAAK,CAAC;oBAC1B,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBAC5B,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACvC,CAAC;YACH,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,WAAW,CAAC,kBAAkB,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,kBAAkB,EAAE,IAAI,EAAE,CAAC;aAC/F,IAAI,CAAC,UAAC,QAAQ;YACb,KAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC;YAClD,KAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC;QACtD,CAAC,CAAC,CAAC,KAAK,CAAC,aAAG;YACZ,KAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC;YAC/B,KAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,KAAK,CAAC;QAClC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,oCAAgB,GAAhB;QAAA,iBAOC;QANC,IAAI,CAAC,eAAe,GAAG,CAAC,IAAI,CAAC,eAAe;QAC5C,EAAE,EAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;YACxB,UAAU,CAAC;gBACT,KAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;YAC5B,CAAC,CAAC,CAAC;QACL,CAAC;QAAA,CAAC;IACJ,CAAC;IAED,8BAAU,GAAV,UAAW,IAAI;QACb,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAClB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAC7B,EAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC;IACrC,CAAC;IAED,qCAAiB,GAAjB,UAAkB,IAAI;QACpB,oBAAoB;QACpB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAC7B,EAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC;IACrC,CAAC;IAED,qCAAiB,GAAjB,UAAkB,KAAK;QACrB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACV,IAAM,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACnC,IAAM,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACnC,IAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAEtC,MAAM,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAChF,CAAC;IACH,CAAC;IAED,4BAAQ,GAAR,UAAS,EAAE;QACT,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC;QACrC,wCAAwC;QACxC,IAAI,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;QAC1B,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;QAEvB,yDAAyD;QACzD,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACR,IAAI,MAAI,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC;YAC7B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ;iBAC1B,MAAM,CAAC,UAAC,OAAO;gBACd,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,MAAI,CAAC,IAAI,CAAC;uBAChD,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,MAAI,CAAC,IAAI,CAAC;uBAC7C,OAAO,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,MAAI,CAAC,IAAI,CAAC;uBACpD,OAAO,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,MAAI,CAAC,IAAI,CAAC,CAAC;YACxD,CAAC,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IACH,gBAAC;AAAD,CAAC;AA7FyB;IAAvB,0EAAS,CAAC,WAAW,CAAC;8BAAW,gEAAS;4CAAC;AADjC,SAAS;IALrB,wEAAS,EAAE;IACX,wEAAS,CAAC;QACT,QAAQ,EAAE,YAAY;OACG;KAC1B,CAAC;yEAgByC;QACX,kFAAS;QACH,gFAAc;QAClB,MAAW;AA4E5C;SA9FY,SAAS;AAgGtB,mCAAmC,IAAI,EAAC,IAAI,CAAU;IACpD,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,4BAA4B;IAC1C,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,GAAC,IAAI,CAAC,CAAmB;IAChD,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,GAAC,IAAI,CAAC,CAAC;IAC9B,IAAI,CAAC,GACH,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,CAAC,CAAC;QACnC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAM;YACjD,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,CAAC,CAAC,CACpC;IACD,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAyB;IACrD,IAAI,CAAC,GAAG,CAAwB;CACvB;AACX,CAAC;AAED,iBAAiB,GAAG;CACQ;AAC5B,CAAC,gC","file":"15.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {StorePage} from './store';\n\n@NgModule({\n  declarations: [\n    StorePage\n  ],\n  imports: [\n    IonicPageModule.forChild(StorePage),\n  ],\n  exports: [\n    StorePage\n  ]\n})\nexport class MasonryCardsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/store/store.module.ts","import {Component, ViewChild} from '@angular/core';\r\nimport {IonicPage, NavController, NavParams, Searchbar} from 'ionic-angular';\r\nimport {ArticleService} from \"../../providers/article.service\";\r\nimport {Geolocation} from '@ionic-native/geolocation';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-store',\r\n  templateUrl: 'store.html',\r\n})\r\nexport class StorePage {\r\n  @ViewChild('searchbar') searchbar:Searchbar;\r\n\r\n  type: string = \"products\";\r\n  articles = [];\r\n  articles_backup = [];\r\n  position: any = {latitude : 0, longitude: 0};\r\n\r\n  subscribeArticle;\r\n\r\n  valueSearch: string;\r\n  isDisplaySearch: boolean;\r\n  onFocusSearch: boolean;\r\n  alive: boolean = true;\r\n\r\n  constructor(public navCtrl: NavController,\r\n              public navParams: NavParams,\r\n              private articleService: ArticleService,\r\n              public geolocation: Geolocation) {\r\n\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.alive = false;\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    //this.articles = this.articleService.getArticles();\r\n    this.subscribeArticle = this.articleService.getArticles().takeWhile(() => this.alive).subscribe(articles => {\r\n        articles.forEach(article => {{\r\n            this.articles.push(article);\r\n            this.articles_backup.push(article);\r\n        }\r\n      })\r\n    });\r\n    this.geolocation.getCurrentPosition({ maximumAge: 3000, timeout: 5000, enableHighAccuracy: true })\r\n      .then((position) => {\r\n        this.position.latitude = position.coords.latitude;\r\n        this.position.longitude = position.coords.longitude;\r\n      }).catch(err => {\r\n      this.position.latitude = \"n/a\";\r\n      this.position.longitude = \"n/a\";\r\n    });\r\n  }\r\n\r\n  displaySearchBar() {\r\n    this.isDisplaySearch = !this.isDisplaySearch\r\n    if(this.isDisplaySearch) {\r\n      setTimeout(() => {\r\n        this.searchbar.setFocus();\r\n      });\r\n    };\r\n  }\r\n\r\n  seeDetails(item) {\r\n    console.log(item);\r\n    this.navCtrl.push('ArticlePage',\r\n      {article: item, key: item.$key});\r\n  }\r\n\r\n  seeDetailsService(item) {\r\n    //console.log(item);\r\n    this.navCtrl.push('ServicePage',\r\n      {service: item, key: item.$key});\r\n  }\r\n\r\n  calculateDistance(value) {\r\n    if (value) {\r\n      const positions = value.split(':');\r\n      const me = positions[0].split(',');\r\n      const other = positions[1].split(',');\r\n\r\n      return getDistanceFromLatLonInKm(me[0], me[1], other[0], other[1]).toFixed(1);\r\n    }\r\n  }\r\n\r\n  getItems(ev) {\r\n    this.articles = this.articles_backup;\r\n    // set val to the value of the ev target\r\n    var val = ev.target.value;\r\n    this.valueSearch = val;\r\n\r\n    // if the value is an empty string don't filter the items\r\n    if (val) {\r\n      let text = val.toLowerCase();\r\n      this.articles = this.articles\r\n        .filter((article) => {\r\n          return article.title.toLowerCase().indexOf(text) >= 0\r\n            || article.type.toLowerCase().indexOf(text) >= 0\r\n            || article.description.toLowerCase().indexOf(text) >= 0\r\n            || article.brand.toLowerCase().indexOf(text) >= 0;\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {\r\n  var R = 6371; // Radius of the earth in km\r\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\r\n  var dLon = deg2rad(lon2-lon1);\r\n  var a =\r\n    Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\r\n    Math.sin(dLon/2) * Math.sin(dLon/2)\r\n  ;\r\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n  var d = R * c; // Distance in km\r\n  return d;\r\n}\r\n\r\nfunction deg2rad(deg) {\r\n  return deg * (Math.PI/180)\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/store/store.ts"],"sourceRoot":""}