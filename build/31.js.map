{"version":3,"sources":["../../src/pages/auth/login/firebase-login.module.ts","../../src/pages/auth/login/firebase-login.ts"],"names":[],"mappings":"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","file":"31.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { FirebaseLoginPage } from './firebase-login';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    FirebaseLoginPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(FirebaseLoginPage),\r\n  ],\r\n})\r\nexport class FirebaseLoginPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/login/firebase-login.module.ts","import {Component, ViewChild} from '@angular/core';\r\nimport { AlertController, LoadingController, IonicPage, NavController, NavParams, MenuController } from 'ionic-angular';\r\nimport { FormGroup, FormBuilder, Validators, AbstractControl } from '@angular/forms';\r\nimport {UserService} from \"../../../providers/user.service\";\r\nimport {AppState} from \"../../../app/global.setting\";\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-firebase-login',\r\n  templateUrl: 'firebase-login.html',\r\n})\r\nexport class FirebaseLoginPage {\r\n\r\n  @ViewChild('email') emailInput;\r\n  @ViewChild('password') passwordInput;\r\n\r\n  loginForm: FormGroup;\r\n  loading: any;\r\n  alert: any;\r\n  email: AbstractControl;\r\n  password: AbstractControl;\r\n  alive: boolean = true;\r\n\r\n  constructor(\r\n    public loadingCtrl: LoadingController,\r\n    public alertCtrl: AlertController,\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    private formBuilder: FormBuilder,\r\n    public userService: UserService,\r\n    public menuCtrl: MenuController,\r\n    public global: AppState\r\n  ) {\r\n    this.loginForm = this.formBuilder.group({\r\n      'email': ['', Validators.compose([Validators.required, Validators.pattern(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/)])],\r\n      'password': ['', Validators.compose([Validators.required, Validators.minLength(1)])]\r\n    });\r\n\r\n    this.email    = this.loginForm.controls['email'];\r\n    this.password = this.loginForm.controls['password'];\r\n\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.alive = false;\r\n  }\r\n\r\n  public doLogin() {\r\n\r\n    var account = ({username: this.email.value.trim(), password: this.password.value.trim()});\r\n\r\n    if(!account.username || !account.password) {\r\n      const alert = this.alertCtrl.create({\r\n        title: 'Error',\r\n        subTitle: 'Please fill fields',\r\n        buttons: ['Dismiss']\r\n      });\r\n      alert.present();\r\n      return;\r\n    }\r\n\r\n    const loading = this.loadingCtrl.create({\r\n      content: 'Please wait while login'\r\n    });\r\n\r\n    loading.present();\r\n\r\n    //console.log(account);\r\n\r\n    this.userService.login(account).then(resp => {\r\n      loading.dismiss();\r\n      this.userService.getProfil(resp.uid).takeWhile(() => this.alive).subscribe(p =>{\r\n        this.userService._profil = p;\r\n        this.global.set('profil', p);\r\n\r\n        this.menuCtrl.enable(true, 'menu-material');\r\n        if(!this.userService._profil.uid) {\r\n          this.navCtrl.setRoot('ProfileSettingsPage', {isNew: true});\r\n        } else {\r\n          this.navCtrl.pop();\r\n          this.navCtrl.setRoot('TabsPage');\r\n        }\r\n      });\r\n    }).catch(err => {\r\n      const alert1 = this.alertCtrl.create({\r\n        title: 'Error',\r\n        subTitle: err.message,\r\n        buttons: ['Dismiss']\r\n      });\r\n      alert1.present();\r\n      loading.dismiss();\r\n    });\r\n  }\r\n\r\n  showLoading() {\r\n    this.loading = this.loadingCtrl.create({\r\n      content: 'Please wait...'\r\n    });\r\n    this.loading.present();\r\n  }\r\n\r\n  showError(text) {\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Fail',\r\n      subTitle: text,\r\n      buttons: ['OK']\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/login/firebase-login.ts"],"sourceRoot":""}